## ðŸš€ Air Quality Prediction Serverless ML System (ID2223/HT2025 Lab 1)

This repository contains the implementation for Lab 1 of the ID2223/HT2025 course , focusing on building a **Serverless AI System** for predicting air quality ($\text{PM}_{2.5}$ levels) using a **Feature Store** (Hopsworks) and cloud compute orchestrators (GitHub Actions).

---

## ðŸŽ¯ Prediction Problem and Data Sources

### Prediction Goal
The core objective is to deliver a daily forecast of the $\text{PM}_{2.5}$ level for the next **7-10 days** at the position of an existing air quality sensor.

### Dynamic Data Sources
The system relies on two main dynamic data sources:
***Air Quality Sensor Data:** Historical and real-time $\text{PM}_{2.5}$ measurements sourced from **https://aqicn.org**. udents are required to select a sensor, in this project specifically from Rome Italy.
* **Weather Forecasts:** Weather features sourced from the **Open-Meteo** free weather API.

---

## ðŸ—ï¸ System Architecture

The project employs a modern MLOps approach using three distinct pipelines (Feature, Training, and Batch Inference) that interact with the **Hopsworks Feature Store**. 

### Key Components

* ]**Feature Store (Hopsworks):** Central repository for processed features and labels.
    * ]**Feature Groups:** `weather` (historical and forecasted weather data) and `air_quality` (historical $\text{PM}_{2.5}$ measurements/labels).
* ]**Orchestration (GitHub Actions / Modal):** Used to schedule and run the feature and batch inference pipelines.
* ]**Model Registry (Hopsworks):** Used to register and manage the trained model.
* ]**Dashboard:** A user interface (UI) to visualize predictions, typically as a GitHub Page (a PNG file generated by Matplotlib).

---

## âœ… Completed Tasks (Grade A: Steps 1-7)

]The following tasks were successfully completed, completing the required task the highest possible grade

### ]Grade 'E' Tasks (Steps 1-5) 

1.  ]**Backfill Feature Pipeline:** Wrote a pipeline to download historical weather data ($>1$ year) and load historical air quality data, registering them as two Feature Groups in Hopsworks.
2.  ]**Daily Feature Pipeline:** Scheduled a pipeline (using **GitHub Actions**) that downloads yesterday's air quality/weather data and the weather prediction for the next 7-10 days, updating the Feature Groups
3.  ]**Training Pipeline:** Wrote a pipeline that selects features, creates a Feature View, reads training data, and trains an XGBoost Regressor model to predict $\text{PM}_{2.5}$
4.  ]**Model Registration:** Registered the trained model with the Hopsworks Model Registry.
5.  ]**Batch Inference Pipeline & Dashboard:** Wrote a pipeline that downloads the model, fetches future feature data, predicts air quality for the next 7-10 days, and creates a dashboard visualization (PNG)
6.  ]**Monitoring:** Implemented a hindcast graph showing past predictions vs. actual measured air quality to monitor prediction accuracy

### ]Grade 'C' Task (Step 6) 

7.  **Feature Engineering and Performance Analysis:**
    * ]**New Feature:** Updated the model by adding **lagged $\text{PM}_{2.5}$ features** (for 1, 2, and 3 previous days).
    * **Performance Improvement:** The addition of lagged air quality data significantly improved the model's performance (e.g., lower RMSE/higher $R^2$). Air quality exhibits strong temporal autocorrelation; including recent historical values captures inertia in the system, providing a robust baseline signal that enhances prediction accuracy beyond what weather features alone can provide

### Grade 'A' Task (Step 7)

8.  **Multi-Sensor City Prediction:**
    * ]The system was successfully adapted to provide predictions for **all available air quality sensors** within Rome, Italy (all the Swedish city were yet chosen by other groups).
    * The batch inference pipeline now handles the complexity of retrieving features and generating forecasts for multiple sensors, and the final dashboard displays the forecasts for all sensors in the selected city.

---

## ðŸ“¦ Deliverables

1.  **Source Code:** All source code is committed to this **GitHub Repository**.
2.  **Lab Description:** This `README.md` file serves as the official lab description.
3.  **Dashboard URL:**
    * **Public URL for the Air Quality Prediction Dashboard:** `https://alessandrobertelli.github.io/mlfs-book/air-quality/`

